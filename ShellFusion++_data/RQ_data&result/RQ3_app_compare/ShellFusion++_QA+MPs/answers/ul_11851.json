{
  "Query": "iptables  allow certain ips and block all other connection",
  "Answers": [
    {
      "Command": "rhost",
      "MP Summary": "resolve a single ip address",
      "Top-3 Similar Questions": [
        "ul_622439: Allow ssh access for users with certain UID from certain IP's"
      ],
      "Top-3 Scripts": [
        "ul_622439: account [success=1 default=ignore] pam_succeed_if.so quiet uid < 6000 uid > 6500\naccount required pam_listfile.so file=/etc/remote-hosts item=rhost sense=allow onerr=fail\n\naccount [success=1 default=ignore] pam_succeed_if.so quiet user notingroup restrictedssh\naccount required pam_listfile.so file=/etc/remote-hosts item=rhost sense=allow onerr=fail"
      ],
      "Explanations about Options": {}
    },
    {
      "Command": "arping",
      "MP Summary": "sends arp and/or ip pings to a given host",
      "Top-3 Similar Questions": [
        "ul_524293: Why linux allows connection on a different interface ip even if forwarding is disabled?"
      ],
      "Top-3 Scripts": [
        "ul_524293: arping -I eth0 1.1.2.1"
      ],
      "Explanations about Options": {}
    },
    {
      "Command": "pam_listfile",
      "MP Summary": "deny or allow services based on an arbitrary file",
      "Top-3 Similar Questions": [
        "ul_622439: Allow ssh access for users with certain UID from certain IP's"
      ],
      "Top-3 Scripts": [
        "ul_622439: "
      ],
      "Explanations about Options": {}
    },
    {
      "Command": "hping3",
      "MP Summary": "send (almost) arbitrary TCP/IP packets to network hosts",
      "Top-3 Similar Questions": [
        "au_955425: Allow X Packets per second with same data length - IPTables"
      ],
      "Top-3 Scripts": [
        "au_955425: sudo hping3 --quiet -c 50 --udp --data 100 --destport 27015 --interval u101000 --spoof 192.168.111.249 192.168.111.104\n\nsudo hping3 --quiet -c 50 --udp --data 100 --destport 27015 --interval u98000 --spoof 192.168.111.249 192.168.111.104\n\n$ sudo hping3 --quiet -c 50 --udp --data 100 --destport 27015 --interval 5 --spoof 192.168.111.249 192.168.111.104"
      ],
      "Explanations about Options": {
        "-c": "Stop after sending (and receiving) count response packets. After last packet was\n send hping3 wait COUNTREACHED_TIMEOUT seconds target host replies. You are able to\n tune COUNTREACHED_TIMEOUT editing hping2.h"
      }
    },
    {
      "Command": "route",
      "MP Summary": "show / manipulate the IP routing table",
      "Top-3 Similar Questions": [
        "ul_12085: Only allow certain outbound traffic on certain interfaces"
      ],
      "Top-3 Scripts": [
        "ul_12085: ip route add default dev eth0 table known\n\nip route add default dev eth1"
      ],
      "Explanations about Options": {}
    }
  ]
}